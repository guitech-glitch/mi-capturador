<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Media Sniffer Online</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #0f172a; color: #f8fafc; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        .container { width: 100%; max-width: 800px; }
        input { width: 80%; padding: 12px; border-radius: 8px; border: none; margin-bottom: 10px; }
        button { padding: 12px 20px; border-radius: 8px; border: none; background: #3b82f6; color: white; cursor: pointer; font-weight: bold; }
        #resultados { background: #1e293b; border-radius: 12px; padding: 15px; height: 500px; overflow-y: auto; margin-top: 20px; border: 1px solid #334155; }
        .item { padding: 8px; border-bottom: 1px solid #334155; font-size: 13px; color: #10b981; word-break: break-all; }
        .status { color: #94a3b8; font-style: italic; margin-bottom: 5px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Capturador Multimedia Web</h1>
        <p>Introduce una URL para ver las peticiones de video/audio en tiempo real.</p>
        <input type="text" id="urlInput" placeholder="https://ejemplo.com/video-embed">
        <button id="btn">Analizar</button>
        <div id="status" class="status"></div>
        <div id="resultados"></div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        const btn = document.getElementById('btn');
        const lista = document.getElementById('resultados');
        const status = document.getElementById('status');

        btn.onclick = () => {
            const url = document.getElementById('urlInput').value;
            if(!url) return alert("Pon una URL");
            lista.innerHTML = "";
            status.innerText = "Iniciando navegador en el servidor...";
            socket.emit('analizar', url);
        };

        socket.on('enlace_encontrado', (link) => {
            status.innerText = "Capturando peticiones...";
            const div = document.createElement('div');
            div.className = 'item';
            div.innerText = link;
            lista.appendChild(div);
        });

        socket.on('finalizado', (msg) => status.innerText = msg);
        socket.on('error', (msg) => status.innerText = msg);
    </script>
</body>
</html>
